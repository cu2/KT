{% extends "ktapp/user_profile_subpages/user_profile_base.html" %}
{% load kt_extras %}

{% block user_profile_main %}

    <form action="{% url 'user_films' selected_user.id selected_user.slug_cache %}" method="get">
        <p>Cím: <input type="text" tabindex="12" name="title" value="{{ querystring.title }}" class="search_input" /></p>
        <p>Év: <input type="text" tabindex="13" name="year" value="{{ querystring.year }}" class="search_input" /> (formátum: <span class="input_format">ÉÉÉÉ</span>, <span class="input_format">ÉÉÉÉ-</span>, <span class="input_format">-ÉÉÉÉ</span>, <span class="input_format">ÉÉÉÉ-ÉÉÉÉ</span>)</p>
        <p>Rendező(k): <input type="text" tabindex="14" name="directors" value="{{ querystring.directors }}" class="search_input input_for_artists" /></p>
        <p>Színész(ek): <input type="text" tabindex="15" name="actors" value="{{ querystring.actors }}" class="search_input input_for_artists" /></p>
        <p>Ország(ok): <input type="text" tabindex="16" name="countries" id="id_countries" value="{{ querystring.countries }}" class="search_input input_for_keywords" /></p>
        <p>Műfaj(ok): <input type="text" tabindex="17" name="genres" id="id_genres" value="{{ querystring.genres }}" class="search_input input_for_keywords" /></p>
        <p>Kulcsszó/szavak: <input type="text" tabindex="18" name="keywords" id="id_keywords" value="{{ querystring.keywords }}" class="search_input input_for_keywords" /></p>
        <p>Átlag: <input type="text" tabindex="19" name="avg_rating_min" value="{{ querystring.avg_rating_min }}" /> - <input type="text" tabindex="20" name="avg_rating_max" value="{{ querystring.avg_rating_max }}" /></p>
        <p>Szavazatok száma: <input type="text" tabindex="21" name="num_rating_min" value="{{ querystring.num_rating_min }}" /> - <input type="text" tabindex="22" name="num_rating_max" value="{{ querystring.num_rating_max }}" /></p>
        <p><input type="submit" value="Mehet" tabindex="23" /></p>
    </form>

    <table class="fullsize">
        <tr class="header_tr">
            <th>Film</th>
            <th>Év</th>
            <th>Átlag</th>
            <th>Szerinte{% if selected_user.id == user.id %}d{% endif %}</th>
            <th>Osztályozva</th>
        </tr>
        {% for r in results %}
            <tr class="{% cycle '' 'odd' %}">
                <td>{{ r.film|film_url_html }}</td>
                <td class="center">{% if r.film.year %}{{ r.film.year }}{% endif %}</td>
                <td class="center">{{ r.film|film_rating_html }}</td>
                <td class="center">{{ r.rating }}</td>
                <td class="center">{{ r.when|date:"Y-m-d" }}</td>
            </tr>
        {% endfor %}
    </table>

    {% if max_pages >= 2 %}
        <ul class="paging">
            <li>{% if p == 1 %}<b>1</b>{% else %}<a href="{% url 'user_films' selected_user.id selected_user.slug_cache %}?{% for key, val in querystring.items %}{{ key }}={{ val }}{% if not forloop.last %}&{% endif %}{% endfor %}">1</a>{% endif %}</li>
            {% if p >= 4 %}
                <li class="paging_ellipsis">...</li>
            {% endif %}
            {% if p >= 3 %}
                <li><a href="{% url 'user_films' selected_user.id selected_user.slug_cache %}?p={{ p|add:"-1" }}&{% for key, val in querystring.items %}{{ key }}={{ val }}{% if not forloop.last %}&{% endif %}{% endfor %}">{{ p|add:"-1" }}</a></li>
            {% endif %}
            {% if 2 <= p and p <= max_pages|add:"-1" %}
                <li><b>{{ p }}</b></li>
            {% endif %}
            {% if p <= max_pages|add:"-2" %}
                <li><a href="{% url 'user_films' selected_user.id selected_user.slug_cache %}?p={{ p|add:"1" }}&{% for key, val in querystring.items %}{{ key }}={{ val }}{% if not forloop.last %}&{% endif %}{% endfor %}">{{ p|add:"1" }}</a></li>
            {% endif %}
            {% if p <= max_pages|add:"-3" %}
                <li class="paging_ellipsis">...</li>
            {% endif %}
            <li>{% if p == max_pages %}<b>{{ max_pages }}</b>{% else %}<a href="{% url 'user_films' selected_user.id selected_user.slug_cache %}?p={{ max_pages }}&{% for key, val in querystring.items %}{{ key }}={{ val }}{% if not forloop.last %}&{% endif %}{% endfor %}">{{ max_pages }}</a>{% endif %}</li>
        </ul>
    {% endif %}

{% endblock %}
